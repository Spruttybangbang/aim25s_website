<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STAGING - Svenska f√∂retag som anv√§nder AI & ML -- databas</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700;900&family=Source+Serif+4:wght@400;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="/static/companies/css/public_view_staging.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Svenska f√∂retag som anv√§nder AI & ML</h1>
            <p class="subtitle subtitle-clickable" onclick="openReleaseNotesModal()">Version 1.1 | Senast uppdaterad 2025-12-18</p>

            <!-- Staging Environment Indicator -->
            <div style="background: #ff6b35; color: white; padding: 0.5rem 1rem; margin: 1rem 0; border-radius: 4px; font-weight: 600; text-align: center;">
                üöß STAGING ENVIRONMENT - Endast synlig lokalt
            </div>

            <!-- Global action icons -->
            <div class="global-actions">
                <button class="global-icon-btn" onclick="openHelpModal()" title="Hj√§lp att f√∂rst√• databasen" aria-label="Hj√§lp">
                    <span class="material-symbols-outlined icon">help_center</span>
                </button>
                <button class="global-icon-btn" onclick="openSuggestionModal()" title="F√∂resl√• nytt f√∂retag" aria-label="F√∂resl√• f√∂retag">
                    <span class="material-symbols-outlined icon">add_box</span>
                </button>
                <button class="global-icon-btn" onclick="window.location.href='/logout/'" title="Logga ut" aria-label="Logga ut">
                    <span class="material-symbols-outlined icon">logout</span>
                </button>
            </div>
        </header>

        <!-- Unified Search & Filter Section (3-column layout) -->
        <div class="unified-filter-section">
            <div class="filter-grid">
                <!-- Column 1: Filter Sections -->
                <div class="filter-column dropdowns-column">
                    <!-- Bransch Filter Section (Collapsible) -->
                    <div class="filter-section" data-filter="bransch">
                        <h4 class="filter-header" onclick="toggleFilterSection('bransch')">
                            <span>Bransch</span>
                            <span class="filter-toggle">‚ñº</span>
                        </h4>
                        <div class="filter-content" id="branschCheckboxContainer">
                            <!-- Populated dynamically from API -->
                        </div>
                    </div>

                    <!-- AI/ML-till√§mpning Filter Section (Collapsible) -->
                    <div class="filter-section" data-filter="tillampning">
                        <h4 class="filter-header" onclick="toggleFilterSection('tillampning')">
                            <span>AI/ML-till√§mpning</span>
                            <span class="filter-toggle">‚ñº</span>
                        </h4>
                        <div class="filter-content">
                            <div class="checkbox-group-vertical">
                                <label class="filter-checkbox tillampning-checkbox">
                                    <input type="checkbox" name="tillampning" value="Optimering & Automation">
                                    <span>Optimering & Automation</span>
                                </label>
                                <label class="filter-checkbox tillampning-checkbox">
                                    <input type="checkbox" name="tillampning" value="Spr√•k & Ljud">
                                    <span>Spr√•k & Ljud</span>
                                </label>
                                <label class="filter-checkbox tillampning-checkbox">
                                    <input type="checkbox" name="tillampning" value="Prognos & Prediktion">
                                    <span>Prognos & Prediktion</span>
                                </label>
                                <label class="filter-checkbox tillampning-checkbox">
                                    <input type="checkbox" name="tillampning" value="Infrastruktur & Data">
                                    <span>Infrastruktur & Data</span>
                                </label>
                                <label class="filter-checkbox tillampning-checkbox">
                                    <input type="checkbox" name="tillampning" value="Insikt & Analys">
                                    <span>Insikt & Analys</span>
                                </label>
                                <label class="filter-checkbox tillampning-checkbox">
                                    <input type="checkbox" name="tillampning" value="Visuell AI">
                                    <span>Visuell AI</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Anst√§llda Filter Section (Collapsible) -->
                    <div class="filter-section" data-filter="anstallda">
                        <h4 class="filter-header" onclick="toggleFilterSection('anstallda')">
                            <span>Anst√§llda</span>
                            <span class="filter-toggle">‚ñº</span>
                        </h4>
                        <div class="filter-content" id="anstalldaCheckboxContainer">
                            <!-- Populated dynamically from API -->
                        </div>
                    </div>

                    <!-- Oms√§ttning Filter Section (Collapsible) -->
                    <div class="filter-section" data-filter="omsattning">
                        <h4 class="filter-header" onclick="toggleFilterSection('omsattning')">
                            <span>Oms√§ttning</span>
                            <span class="filter-toggle">‚ñº</span>
                        </h4>
                        <div class="filter-content" id="omsattningCheckboxContainer">
                            <!-- Populated dynamically from API -->
                        </div>
                    </div>
                </div>

                <!-- Column 2: Search & Checkboxes -->
                <div class="filter-column search-column">
                    <input type="text" id="searchInput"
                           placeholder="S√∂k f√∂retag, stad, kommun..." autocomplete="off">

                    <div class="search-buttons-row">
                        <button id="searchButton">S√∂k</button>
                        <button id="luckyButton" class="btn-lucky">
                            <span class="btn-lucky-text">I feel lucky</span>
                            <span class="btn-lucky-loading" style="display: none;">
                                <span class="loading-dots">Slumpar</span>
                            </span>
                        </button>
                    </div>

                    <div class="checkbox-group">
                        <label class="filter-checkbox">
                            <input type="checkbox" id="stockholmFilter">
                            <span>Endast stor-Stockholm</span>
                        </label>

                        <label class="filter-checkbox">
                            <input type="checkbox" id="arbetsgivareFilter">
                            <span>Endast registrerade arbetsgivare</span>
                        </label>
                    </div>

                    <button id="clearFilters" class="btn-clear-filters">Rensa alla filter</button>
                </div>

                <!-- Column 3: Chart -->
                <div class="filter-column stats-column">
                    <!-- Batteristapel visualisering -->
                    <div class="battery-container">
                        <!-- Hj√§lptext √∂ver batteriet -->
                        <div class="battery-help-text">
                            Klicka h√§r f√∂r mer datainfo <span class="battery-arrow">‚Üì</span>
                        </div>
                        <!-- Batteristapel -->
                        <div class="battery-bar">
                            <div class="battery-background"></div>
                            <div class="battery-fill" id="batteryFill" style="height: 100%;"></div>
                            <div class="battery-counter" id="batteryCounter">0</div>
                        </div>
                        <!-- Label under stapeln -->
                        <div class="battery-label">Antal f√∂retag</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Active Filter Pills Section (NEW) -->
        <div id="activeFiltersContainer" class="active-filters-container" style="display: none;">
            <div class="active-filters-pills" id="activeFiltersPills">
                <!-- Pills generated dynamically -->
            </div>
        </div>

        <!-- Legacy stats element (kept for compatibility) -->
        <div style="display: none;">
            <span id="totalCompanies">Laddar...</span>
        </div>

        <!-- Loading spinner -->
        <div id="loadingSpinner" class="loading">
            <div class="spinner"></div>
            <p>Laddar f√∂retag...</p>
        </div>

        <!-- Error message -->
        <div id="errorMessage" class="error-message" style="display: none;">
            <p>Ett fel uppstod vid laddning av data. F√∂rs√∂k igen.</p>
        </div>

        <!-- Desktop Table View -->
        <div class="table-container desktop-view">
            <table id="companiesTable">
                <thead>
                    <tr id="tableHeaders">
                        <!-- Headers will be populated dynamically -->
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <!-- Data will be populated dynamically -->
                </tbody>
            </table>
        </div>

        <!-- Mobile Card View -->
        <div class="cards-container mobile-view" id="mobileCards">
            <!-- Cards will be populated dynamically -->
        </div>

        <!-- Pagination -->
        <div class="pagination" id="pagination">
            <button id="prevPage" disabled>F√∂reg√•ende</button>
            <span id="pageInfo">Sida 1 av 1</span>
            <button id="nextPage" disabled>N√§sta</button>
        </div>
    </div>

    <!-- Modal for Company Details -->
    <div id="companyModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="modalBody">
                <!-- Company details will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Modal for Error Reporting -->
    <div id="errorReportModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeErrorReportModal()">&times;</span>
            <div id="errorReportBody">
                <h2>Rapportera fel</h2>
                <p class="error-report-subtitle">Hj√§lp oss f√∂rb√§ttra informationen om <span id="errorCompanyName"></span></p>

                <form id="errorReportForm">
                    <input type="hidden" id="errorCompanyId" name="company_id">

                    <div class="form-group">
                        <label for="errorType">Typ av fel *</label>
                        <select id="errorType" name="error_type" required>
                            <option value="">V√§lj feltyp...</option>
                            <option value="incorrect_info">Felaktig information</option>
                            <option value="company_not_exist">F√∂retaget finns ej</option>
                            <option value="missing_data">Saknad data</option>
                            <option value="other">Annat</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="errorDescription">Beskrivning av felet *</label>
                        <textarea id="errorDescription" name="description" rows="4" required placeholder="Beskriv vad som √§r fel..."></textarea>
                    </div>

                    <div class="form-group">
                        <label for="errorSuggestion">F√∂rslag p√• korrigering</label>
                        <textarea id="errorSuggestion" name="suggestion" rows="3" placeholder="Om du vet den korrekta informationen, skriv den h√§r..."></textarea>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="closeErrorReportModal()">Avbryt</button>
                        <button type="submit" class="btn-primary">Skicka felanm√§lan</button>
                    </div>
                </form>

                <div id="errorReportSuccess" style="display: none;">
                    <p class="success-message">‚úì Tack f√∂r din felanm√§lan! Vi kommer att granska den s√• snart som m√∂jligt.</p>
                    <button class="btn-primary" onclick="closeErrorReportModal()">St√§ng</button>
                </div>

                <div id="errorReportError" style="display: none;">
                    <p class="error-message">‚úó N√•got gick fel. F√∂rs√∂k igen senare.</p>
                    <button class="btn-secondary" onclick="closeErrorReportModal()">St√§ng</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="helpModal" class="modal">
        <div class="modal-content modal-wide">
            <span class="close" onclick="closeHelpModal()">&times;</span>
            <div id="helpModalBody">
                <h2>Hj√§lp att f√∂rst√• databasen</h2>

                <div class="help-content">
                    <p>Denna databas har samlat f√∂retag fr√•n officiella k√§llor (s√•som AI Sweden och EU) som listar AI-f√∂retag i Sverige. Denna data has sedan korsk√∂rts med Bolagsverkets information p√• f√∂retagen och sedan harmoniserats med hj√§lp av generativ AI.</p>

                    <p>Databasen kan inneh√•lla fel eller gammal data, om du uppt√§cker n√•got fel f√•r du g√§rna rapportera det. Du kan ocks√• f√∂resl√• f√∂retag som b√∂r finnas med p√• listan, du hittar det formul√§ret bredvid ikonen till denna hj√§lptext.</p>

                    <h3>F√∂rklaringar</h3>

                    <h4>Bransch</h4>
                    <p>Denna etikett beskriver f√∂retagets prim√§ra kundgrupp eller den industri d√§r deras l√∂sning g√∂r mest nytta. Vi delar in detta i vertikala branscher och horisontella teknikomr√•den.</p>

                    <h5>Vertikala kluster (Marknader)</h5>
                    <p>Dessa f√∂retag applicerar AI f√∂r att l√∂sa specifika problem inom en viss industri.</p>
                    <ul>
                        <li><strong>Energy & ClimateTech:</strong> L√∂sningar f√∂r energisystem, h√•llbarhet, milj√∂analys och gr√∂n teknik (Cleantech).</li>
                        <li><strong>FinTech:</strong> Bank, finans och f√∂rs√§kring. Innefattar bedr√§geridetektion, riskanalys och automatiserad ekonomihantering.</li>
                        <li><strong>HealthTech & Life Science:</strong> V√•rd, medicinsk diagnostik, l√§kemedelsutveckling (Drug Discovery) och bioteknik.</li>
                        <li><strong>Industrial & Manufacturing:</strong> Tillverkningsindustri, robotik, fabriksautomation och "Industry 4.0".</li>
                        <li><strong>Logistics & Mobility:</strong> Allt som r√∂r f√∂rflyttning av varor och m√§nniskor. Innefattar fordonsutveckling, autonoma system, transportplanering och supply chain-optimering.</li>
                        <li><strong>Public Sector:</strong> L√∂sningar riktade mot offentlig sektor, myndigheter, kommuner, f√∂rsvar och samh√§llsservice.</li>
                        <li><strong>Retail & E-commerce:</strong> Detaljhandel och e-handel. Fokus p√• kundanalys, lagerhantering och k√∂pupplevelser.</li>
                    </ul>

                    <h5>Horisontella kluster (Teknik & Tj√§nster)</h5>
                    <p>Dessa f√∂retag erbjuder teknik eller tj√§nster som kan anv√§ndas av flera olika branscher.</p>
                    <ul>
                        <li><strong>Consulting & Enterprise:</strong> Konsultbolag som hj√§lper andra att implementera AI, samt breda aff√§rssystem (SaaS) som effektiviserar interna processer (HR, s√§lj, admin).</li>
                        <li><strong>Core AI/ML & Research:</strong> F√∂retag som bygger sj√§lva grundtekniken, plattformar f√∂r maskininl√§rning (MLOps) eller bedriver tung forskning.</li>
                        <li><strong>GenAI & NLP:</strong> Specialister inom spr√•kteknologi och generativ AI. H√§r hittar du textanalys, chattbotar och verktyg f√∂r att skapa inneh√•ll.</li>
                    </ul>

                    <h4>AI/ML-till√§mpningar</h4>
                    <p>Denna kolumn beskriver <em>vad</em> AI-tekniken faktiskt g√∂r hos f√∂retaget. Ett f√∂retag kan ha en eller flera till√§mpningsomr√•den.</p>

                    <ul>
                        <li><strong>Optimering & Automation:</strong> F√∂retag som anv√§nder AI f√∂r att optimera processer, schemal√§ggning, logistik eller automatisera arbetsfl√∂den. Inkluderar RPA (Robotic Process Automation), robotstyrning och matematisk optimering.</li>

                        <li><strong>Spr√•k & Ljud:</strong> F√∂retag som arbetar med spr√•kteknologi och ljudanalys. Inkluderar chattbotar, generativ AI f√∂r text, talsyntes (TTS), taligenk√§nning (STT), √∂vers√§ttning och ljudanalys.</li>

                        <li><strong>Prognos & Prediktion:</strong> F√∂retag som anv√§nder AI f√∂r att f√∂rutsp√• framtida h√§ndelser baserat p√• historisk data. Inkluderar f√∂rs√§ljningsprognoser, riskanalys, rekommendationsmotorer och prediktiv underh√•ll.</li>

                        <li><strong>Infrastruktur & Data:</strong> F√∂retag som bygger infrastruktur och verktyg f√∂r AI/ML. Inkluderar MLOps-plattformar, datapipelines, datavisualisering, edge AI, digital twins och syntetisk data.</li>

                        <li><strong>Insikt & Analys:</strong> F√∂retag som anv√§nder AI f√∂r att analysera data och ge insikter. Inkluderar anomalidetektion, beslutst√∂d, graf-analys, sentiment-analys och smarta s√∂ksystem.</li>

                        <li><strong>Visuell AI:</strong> F√∂retag som arbetar med datorseende och bildanalys. Inkluderar objektdetektering, ansiktsigenk√§nning, medicinsk bildanalys, OCR, videoanalytik, autonom navigation och kvalitetskontroll.</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Company Suggestion Modal -->
    <div id="suggestionModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeSuggestionModal()">&times;</span>
            <div id="suggestionModalBody">
                <h2>F√∂resl√• nytt f√∂retag</h2>
                <p class="suggestion-subtitle">Hj√§lp oss bygga en komplett databas √∂ver AI-f√∂retag i Sverige</p>

                <form id="suggestionForm">
                    <div class="form-group">
                        <label for="suggestionCompanyName">F√∂retagsnamn *</label>
                        <input type="text" id="suggestionCompanyName" name="company_name" required placeholder="T.ex. AI Solutions AB">
                    </div>

                    <div class="form-group">
                        <label for="suggestionWebsite">Hemsida *</label>
                        <input type="url" id="suggestionWebsite" name="website" required placeholder="https://exempel.se">
                    </div>

                    <div class="form-group">
                        <label for="suggestionAdditionalInfo">Ytterligare information (frivilligt)</label>
                        <textarea id="suggestionAdditionalInfo" name="additional_info" rows="3" placeholder="Ber√§tta g√§rna mer om f√∂retaget och varf√∂r det b√∂r l√§ggas till..."></textarea>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="closeSuggestionModal()">Avbryt</button>
                        <button type="submit" class="btn-primary">Skicka f√∂rslag</button>
                    </div>
                </form>

                <div id="suggestionSuccess" style="display: none;">
                    <p class="success-message">‚úì Tack f√∂r ditt f√∂retagsf√∂rslag! Vi kommer att granska det s√• snart som m√∂jligt.</p>
                    <button class="btn-primary" onclick="closeSuggestionModal()">St√§ng</button>
                </div>

                <div id="suggestionError" style="display: none;">
                    <p class="error-message">‚úó N√•got gick fel. F√∂rs√∂k igen senare.</p>
                    <button class="btn-secondary" onclick="closeSuggestionModal()">St√§ng</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Database Insights Modal -->
    <div id="databaseModal" class="modal">
        <div class="modal-content modal-wide">
            <span class="close" onclick="closeDatabaseModal()">&times;</span>

            <h2 style="font-family: 'Playfair Display', serif; font-weight: 700; margin-bottom: 2rem;">
                Database Insights
            </h2>

            <div id="databaseInsightsContainer" style="max-height: 70vh; overflow-y: auto; padding-right: 1rem;">

                <!-- √ñversikt Section -->
                <div class="insight-section">
                    <h3>√ñversikt</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <span class="stat-number" id="statTotalCompanies">0</span>
                            <span class="stat-label">F√∂retag totalt</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">37</span>
                            <span class="stat-label">Variabler data</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">22 817</span>
                            <span class="stat-label">Celler data</span>
                        </div>
                    </div>
                </div>

                <!-- Geografisk Spridning Section -->
                <div class="insight-section">
                    <h3>Geografisk Spridning</h3>
                    <p class="section-description">Distribution av f√∂retag per stad (topp 5 + √∂vriga)</p>
                    <div class="chart-container">
                        <canvas id="geographicChart"></canvas>
                    </div>
                </div>

                <!-- Branschf√∂rdelning Section -->
                <div class="insight-section">
                    <h3>Branschf√∂rdelning</h3>
                    <p class="section-description">Distribution av f√∂retag per branschkluster</p>
                    <div class="chart-container">
                        <canvas id="branschChart"></canvas>
                    </div>
                </div>

                <!-- Till√§mpningar Section -->
                <div class="insight-section">
                    <h3>AI-Till√§mpningar</h3>
                    <p class="section-description">Antal f√∂retag per till√§mpningsomr√•de</p>
                    <div class="chart-container">
                        <canvas id="applicationsChart"></canvas>
                    </div>
                </div>

                <!-- Oms√§ttning Section -->
                <div class="insight-section">
                    <h3>Oms√§ttningsf√∂rdelning</h3>
                    <p class="section-description">F√∂retag grupperade efter oms√§ttning</p>
                    <div class="chart-container">
                        <canvas id="revenueChart"></canvas>
                    </div>
                </div>

                <!-- Anst√§llda Section -->
                <div class="insight-section">
                    <h3>F√∂retagsstorlek (Anst√§llda)</h3>
                    <p class="section-description">F√∂retag grupperade efter antal anst√§llda</p>
                    <div class="chart-container">
                        <canvas id="employeesChart"></canvas>
                    </div>
                </div>

                <!-- Data Source Footer -->
                <div class="insight-footer">
                    <p><strong>Datak√§lla:</strong> AIM25S F√∂retagsdatabas</p>
                    <p><em>Uppdaterad: 2025-12-15</em></p>
                </div>

            </div>
        </div>
    </div>

    <!-- Release Notes Modal -->
    <div id="releaseNotesModal" class="modal">
        <div class="modal-content modal-medium">
            <span class="close" onclick="closeReleaseNotesModal()">&times;</span>

            <h2 style="font-family: 'Playfair Display', serif; font-weight: 700; margin-bottom: 2rem;">
                Version History
            </h2>

            <!-- Version 1.1 -->
            <div class="release-section">
                <div class="release-header">
                    <h3>Version 1.1</h3>
                    <span class="release-date">2025-12-18</span>
                </div>

                <ul>
                    <li>Klickbar database insights dashboard med Chart.js visualiseringar</li>
                    <li>Multi-select filter f√∂r alla kategorier</li>
                    <li>6 nya AI/ML-till√§mpningsf√§lt ers√§tter AI-inriktning</li>
                    <li>Server-side filtering (visar alla matchande f√∂retag)</li>
                    <li>Expanderbara filter sections</li>
                </ul>
            </div>

            <!-- Version 1.0 -->
            <div class="release-section">
                <div class="release-header">
                    <h3>Version 1.0</h3>
                    <span class="release-date">2025-12-12</span>
                </div>

                <ul>
                    <li>Interaktiv f√∂retagsdatabas med 613 AI-f√∂retag</li>
                    <li>S√∂k- och filterfunktion</li>
                    <li>Batterim√§tare och "I feel lucky" button</li>
                    <li>Rapportera fel och f√∂resl√• f√∂retag</li>
                    <li>Editorial design aesthetic</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Chart.js Library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="/static/companies/js/public_view_staging.js"></script>
</body>
</html>
